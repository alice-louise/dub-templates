console.warn("1.0 CONDITIONAL SCRIPT LOADED");const CONDITIONAL_PREFIXES=["conditional-display","conditional-trigger","conditional-group","conditional-disable-group","conditional-hide-trigger","conditional-hide-display"];const EDIT_CONTEXT_SELECTORS=["view-form-public-component","legacy-form-preview-component","#edit-form","#view-form"];const CLASS_KEEPERS=new Set(["row","item","packageNotSelected","packageSelected","selected","ng-scope","column"]);function getClassTokens(node){return node.classList.toString().split(" ").map(c=>c.trim()).filter(c=>c!=="")}function isTriggerSelected(trigger){if(!trigger)return false;const input=trigger.querySelector("input, select");if(!input)return false;if(input.type==="checkbox"||input.type==="radio"){return input.checked}if(input.tagName==="SELECT"){return input.value!==""}return false}function safeAddClass(element,className){if(!element||!element.classList||!className)return;const clean=className.trim();if(clean===""||/\s/.test(clean))return;element.classList.add(clean)}function hasEditContext(){return EDIT_CONTEXT_SELECTORS.some(selector=>document.querySelector(selector)!==null)}function hasFormViewer(){return document.querySelector(".form-viewer")!==null}function normalizeForCSS(value){return value.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-_]/g,"")}function displayValueMatchesTrigger(displayNode,trigger){const displayValues=Array.from(displayNode.classList).filter(c=>c.startsWith("cl-value-")).map(c=>c.replace("cl-value-",""));if(displayValues.length===0)return true;const column=trigger.closest(".container-form-element__column")||trigger.closest(".column");if(!column)return false;const checkedRadio=column.querySelector("input[type='radio']:checked");if(checkedRadio){const label=checkedRadio.closest(".radio-option")?.querySelector("label");if(!label)return false;const normalized=normalizeForCSS(label.textContent||"");return displayValues.includes(normalized)}const select=column.querySelector("select");if(select&&select.selectedIndex>-1&&select.options[select.selectedIndex]&&!select.options[select.selectedIndex].disabled&&select.value!==""){const selectedOption=select.options[select.selectedIndex];const normalized=normalizeForCSS(selectedOption.value||selectedOption.textContent||"");return displayValues.includes(normalized)}return false}function hasSelectedPackageOrInput(node){if(!node)return false;if(node.querySelector(".packageSelected")!==null||node.querySelector("input[type='checkbox']:checked")!==null||node.querySelector("input[type='radio']:checked")!==null){return true}const select=node.querySelector("select");return!!(select&&select.value!=="")}function assignConditionalLogic(prefix){const identifierClass=`${prefix}-identify`;const targetClass=`${prefix}-id`;const nodes=document.getElementsByClassName(identifierClass);for(let i=0;i<nodes.length;i+=1){const node=nodes[i];const classTokens=getClassTokens(node);for(let j=0;j<classTokens.length;j+=1){const classToken=classTokens[j];if(!classToken.includes("cl-")&&!classToken.includes("clhide-")){continue}const column=hasFormViewer()?node.closest(".container-form-element__column"):node.closest(".column");if(!column)continue;if(node.parentNode&&node.parentNode.style){node.parentNode.style.minHeight="0"}safeAddClass(column,classToken);column.classList.add(targetClass);column.classList.add("conditional-id")}}}function assignConditionalClasses(){CONDITIONAL_PREFIXES.forEach(prefix=>assignConditionalLogic(prefix))}function addCheckboxID(){if(!hasFormViewer()){return}const checkboxes=document.querySelectorAll("input[type='checkbox']");checkboxes.forEach(checkbox=>{const wrapper=checkbox.closest(".checkbox-option");if(!wrapper)return;wrapper.classList.toggle("checkboxChecked",checkbox.checked);wrapper.classList.toggle("checkboxNotChecked",!checkbox.checked)})}function setCollapsedState(displayNode,isVisible){const displayParent=displayNode.parentNode;if(!displayParent)return;if(isVisible){displayNode.classList.add("show-content");displayParent.classList.remove("remove-padding")}else{displayNode.classList.remove("show-content");displayParent.classList.add("remove-padding")}}function conditionalLogic(){const displayNodes=document.getElementsByClassName("conditional-display-id");for(let i=0;i<displayNodes.length;i+=1){let shouldShow=false;const displayNode=displayNodes[i];const classTokens=getClassTokens(displayNode);for(let j=0;j<classTokens.length;j+=1){const classToken=classTokens[j];if(!classToken.includes("cl-"))continue;const triggers=document.getElementsByClassName("conditional-trigger-id");for(let k=0;k<triggers.length;k+=1){const trigger=triggers[k];if(!trigger.classList.contains(classToken))continue;const selected=isTriggerSelected(trigger)&&displayValueMatchesTrigger(displayNode,trigger);shouldShow=shouldShow||selected}}setCollapsedState(displayNode,shouldShow)}}function conditionalLogicDisableFunction(){addCheckboxID();const groups=document.getElementsByClassName("conditional-group-disable-id");for(let i=0;i<groups.length;i+=1){const groupNode=groups[i];const classTokens=getClassTokens(groupNode);for(let j=0;j<classTokens.length;j+=1){const classToken=classTokens[j];if(!classToken.includes("group-cl-"))continue;const members=document.querySelectorAll(`.${classToken}`);let anySelected=false;members.forEach(member=>{anySelected=anySelected||hasSelectedPackageOrInput(member)});members.forEach(member=>{const packages=member.getElementsByClassName("packageNotSelected");for(let index=0;index<packages.length;index+=1){packages[index].classList.toggle("disable-package",anySelected)}const unchecked=hasFormViewer()?member.querySelectorAll(".checkboxNotChecked"):member.querySelectorAll(".clip-check .ng-empty");for(let index=0;index<unchecked.length;index+=1){if(hasFormViewer()){unchecked[index].classList.toggle("disable-package",anySelected)}else if(unchecked[index].parentElement){unchecked[index].parentElement.classList.toggle("disable-package",anySelected)}}if(hasFormViewer()){const checked=member.querySelectorAll(".checkboxChecked");for(let index=0;index<checked.length;index+=1){checked[index].classList.remove("disable-package")}}})}}}function runConditionalCycle(){conditionalLogicDisableFunction();conditionalLogic()}function attachConditionalListeners(){document.addEventListener("click",runConditionalCycle,false);document.addEventListener("change",event=>{if(event.target&&(event.target.matches("select")||event.target.matches("input[type='checkbox']")||event.target.matches("input[type='radio']"))){runConditionalCycle()}},false)}function removeConditionalLogicDisplay(){if(document.querySelector("#edit-form")===null){return}const displayNodes=document.querySelectorAll(".conditional-display-id");displayNodes.forEach(displayNode=>{displayNode.classList.remove("conditional-display-id");const classTokens=getClassTokens(displayNode);classTokens.forEach(classToken=>{const keep=CLASS_KEEPERS.has(classToken)||classToken.includes("col-")||classToken.includes(" ");if(!keep){displayNode.classList.remove(classToken)}})})}function removeConditionalLogicTrigger(){if(document.querySelector("#edit-form")===null){return}const triggerNodes=document.querySelectorAll(".conditional-trigger-id");triggerNodes.forEach(triggerNode=>{triggerNode.classList.remove("conditional-trigger-id");const classTokens=getClassTokens(triggerNode);classTokens.forEach(classToken=>{const keep=CLASS_KEEPERS.has(classToken)||classToken.includes("col-")||classToken.includes(" ");if(!keep){triggerNode.classList.remove(classToken)}})})}function removeConditionalGroup(){if(document.querySelector("#edit-form")===null){return}const groupNodes=document.querySelectorAll(".conditional-group-id");groupNodes.forEach(groupNode=>{groupNode.classList.remove("conditional-group-id");const classTokens=getClassTokens(groupNode);classTokens.forEach(classToken=>{const keep=CLASS_KEEPERS.has(classToken)||classToken.includes("col-")||classToken.includes(" ");if(!keep){groupNode.classList.remove(classToken)}})})}function whileEdit(){if(document.querySelector("#edit-form")!==null){setInterval(()=>{removeConditionalLogicDisplay();removeConditionalLogicTrigger();removeConditionalGroup();assignConditionalClasses()},250)}}function startJavascript(){assignConditionalClasses();addCheckboxID();runConditionalCycle();whileEdit();attachConditionalListeners()}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",startJavascript)}else{startJavascript()}
